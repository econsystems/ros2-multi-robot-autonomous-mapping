# Shared parameters for all robots
amcl_common: &amcl_common  # Define the anchor here
  ros__parameters:
    use_sim_time: True
    alpha1: 0.2
    alpha2: 0.2
    alpha3: 0.2
    alpha4: 0.2
    alpha5: 0.2
    beam_skip_distance: 0.5
    beam_skip_error_threshold: 0.9
    beam_skip_threshold: 0.3
    do_beamskip: false
    global_frame_id: "map"
    lambda_short: 0.1
    laser_likelihood_max_dist: 2.0
    laser_max_range: 100.0
    laser_min_range: -1.0
    laser_model_type: "likelihood_field"
    max_beams: 60
    max_particles: 2000
    min_particles: 500
    pf_err: 0.05
    pf_z: 0.99
    recovery_alpha_fast: 0.0
    recovery_alpha_slow: 0.0
    resample_interval: 1
    robot_model_type: "nav2_amcl::DifferentialMotionModel"
    save_pose_rate: 0.5
    sigma_hit: 0.2
    tf_broadcast: true
    transform_tolerance: 1.0
    update_min_a: 0.2
    update_min_d: 0.25
    z_hit: 0.5
    z_max: 0.05
    z_rand: 0.5
    z_short: 0.05
    scan_topic: scan
    map_topic: /map

# Namespace for tb1
tb1/amcl:
  <<: *amcl_common  # Use the alias here
  ros__parameters:
    base_frame_id: "tb1/base_footprint"
    odom_frame_id: "tb1/odom"

# Namespace for tb2
tb2/amcl:
  <<: *amcl_common  # Use the alias here
  ros__parameters:
    base_frame_id: "tb2/base_footprint"
    odom_frame_id: "tb2/odom"

# Define a local costmap alias for reuse
local_costmap_common: &local_costmap_common  # Create an alias for the local costmap
  ros__parameters:
    update_frequency: 5.0
    publish_frequency: 2.0
    global_frame: odom
    use_sim_time: True
    rolling_window: true
    map_topic: /map
    width: 3
    height: 3
    resolution: 0.05
    robot_radius: 0.22
    plugins: ["voxel_layer", "inflation_layer"]
    inflation_layer:
      plugin: "nav2_costmap_2d::InflationLayer"
      cost_scaling_factor: 3.0
      inflation_radius: 0.55
    voxel_layer:
      plugin: "nav2_costmap_2d::VoxelLayer"
      enabled: True
      publish_voxel_map: True
      origin_z: 0.0
      z_resolution: 0.05
      z_voxels: 16
      max_obstacle_height: 2.0
      mark_threshold: 0
      observation_sources: scan
      scan:
        topic: /scan
        max_obstacle_height: 2.0
        clearing: True
        marking: True
        data_type: "LaserScan"
    static_layer:
      map_subscribe_transient_local: True
    always_send_full_costmap: True

# Local costmap for tb1
tb1/local_costmap:
  <<: *local_costmap_common  # Reuse the common costmap
  ros__parameters:
    robot_base_frame: tb1/base_link  # Specific to tb1

# Local costmap for tb2
tb2/local_costmap:
  <<: *local_costmap_common  # Reuse the common costmap
  ros__parameters:
    robot_base_frame: tb2/base_link  # Specific to tb2
